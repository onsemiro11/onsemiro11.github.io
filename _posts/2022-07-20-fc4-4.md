{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "b89f90c1",
   "metadata": {},
   "source": [
    "# 4-1: Datasets"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "52240820-d81a-4b57-b7f6-d2b79f775d9f",
   "metadata": {},
   "source": [
    "원하는 datasets을 만들자.\n",
    "\n",
    "사진으로 구성된 datasets는 대용량의 저장공간을 요구한다. 이런 datasets를 구동하려면, 데이터의 크기 만큼의 ram이 있어야하는데 그건 큰 비용이 들기 때문에,\n",
    "\n",
    "어떻게 datasets를 구성할 것이고 세팅할 것인지를 먼저 공부해야한다. 이럴때, minibatch개념을 사용한다.\n",
    "\n",
    "학습이 어떻게 되는지 확인할 줄알아야한다.\n",
    "\n",
    "이번에는 정답을 알고 있는 datasets를 가지고 학습이 어떻게 진행되는지 공부해보자."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "140567af-3c9f-4f32-9b35-5f63c894dcb2",
   "metadata": {},
   "source": [
    "## Code.4-1-1: Dataset for Regression\n",
    "\n",
    "linear regression을 위한 dataset을 만들어보자."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e2e10a1b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Init Plugin\n",
      "Init Graph Optimizer\n",
      "Init Kernel\n",
      "Metal device set to: Apple M1\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-07-12 03:32:21.142566: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:305] Could not identify NUMA node of platform GPU ID 0, defaulting to 0. Your kernel may not have been built with NUMA support.\n",
      "2022-07-12 03:32:21.142743: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:271] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 0 MB memory) -> physical PluggableDevice (device: 0, name: METAL, pci bus id: <undefined>)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "X(shape/dtype/data): (8, 5) / <dtype: 'float32'> \n",
      "[[ 1.3089654  -0.5528932   0.688073    0.67694473  0.1775935 ]\n",
      " [-0.6953412  -0.35054824  0.20103182 -0.516342    0.0054038 ]\n",
      " [ 0.0152084   0.42373955 -0.42877418  0.06064195  0.6370858 ]\n",
      " [ 0.79507554  0.511674   -0.00893835  1.8508373   0.95486   ]\n",
      " [ 2.3959115   1.606947   -0.7018826  -0.22188915 -0.5929313 ]\n",
      " [-1.3212442   0.3351333   0.10565124 -1.1738453   1.6917982 ]\n",
      " [-0.7729018  -0.8315673   0.8476237   0.38773188  0.36791158]\n",
      " [ 0.8532647   0.19871233  0.5975337   0.05254836 -0.44423676]]\n",
      "\n",
      "Y(shape/dtype/data): (8,) / <dtype: 'float32'> \n",
      "[15.863144   7.1683087 13.004362  23.969257   9.651945  13.429586\n",
      " 13.49732   11.0323   ]\n",
      "\n"
     ]
    }
   ],
   "source": [
    "import tensorflow as tf\n",
    "\n",
    "N, n_feature = 8, 5\n",
    "t_weights = tf.constant([1,2,3,4,5],dtype=tf.float32) #t_weights는 [1,2,3,4,5]가 5행 1열이다.\n",
    "t_bias = tf.constant([10],dtype=tf.float32)\n",
    "\n",
    "#print(t_weights)\n",
    "#print(t_bias)\n",
    "\n",
    "X = tf.random.normal(mean=0, stddev=1, shape=(N, n_feature))\n",
    "\n",
    "Y = tf.reduce_sum(t_weights * X, axis = 1) + t_bias #tf.reduce_sum에서 axis =1을 활용해서 가로행을 기준으로 더해나간 값과 t_bias와 더하게 된다.\n",
    "print(\"X(shape/dtype/data): {} / {} \\n{}\\n\".format(X.shape,X.dtype,X.numpy()))\n",
    "print(\"Y(shape/dtype/data): {} / {} \\n{}\\n\".format(Y.shape,Y.dtype,Y.numpy()))\n",
    "\n",
    "#linear regression을 만들게 된 것이다."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ee718aec-39ab-4ccc-8e03-902be159b3e6",
   "metadata": {},
   "source": [
    "## Code.4-1-2: Dataset for Binary Classification\n",
    "\n",
    "y의 값들이 0또는 1로 구성되어있음."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "14a5887f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "tf.Tensor(\n",
      "[ 8.873461  14.550608   2.7728624  8.910473  12.090711  17.58218\n",
      " 18.718176  14.1441765], shape=(8,), dtype=float32)\n",
      "tf.Tensor([ True  True False  True  True  True  True  True], shape=(8,), dtype=bool)\n",
      "tf.Tensor([1 1 0 1 1 1 1 1], shape=(8,), dtype=int32)\n",
      "X(shape/dtype/data): (8, 5) / <dtype: 'float32'> \n",
      "[[ 8.9829659e-01 -1.8112229e+00 -2.0802169e-01 -2.6114425e-01\n",
      "   6.5325028e-01]\n",
      " [ 4.9372122e-01  8.9845216e-01  2.3015289e-02  1.1514680e+00\n",
      "  -4.8298711e-01]\n",
      " [-1.8204662e-01  1.1002833e+00  8.5253215e-01 -7.4058032e-01\n",
      "  -1.7681865e+00]\n",
      " [ 9.0333486e-01  8.4391522e-01  6.1158311e-01 -3.6419332e-01\n",
      "  -8.1173372e-01]\n",
      " [ 4.8573792e-01 -4.9588168e-01  4.8733971e-01  8.3642250e-01\n",
      "  -4.4219455e-01]\n",
      " [-6.7665863e-01  3.7484625e-01 -1.5315638e-03 -3.7257794e-02\n",
      "   1.5325545e+00]\n",
      " [-1.3425210e-01 -1.2327292e+00  3.8972083e-01 -1.0459484e-01\n",
      "   2.1134207e+00]\n",
      " [-6.2299287e-01  1.0128933e-01  7.2140306e-01  1.1388125e+00\n",
      "  -4.3097365e-01]]\n",
      "\n",
      "Y(shape/dtype/data): (8,) / <dtype: 'int32'> \n",
      "[1 1 0 1 1 1 1 1]\n",
      "\n"
     ]
    }
   ],
   "source": [
    "import tensorflow as tf\n",
    "\n",
    "N, n_feature = 8, 5\n",
    "t_weights = tf.constant([1,2,3,4,5],dtype=tf.float32) #t_weights는 [1,2,3,4,5]가 5행 1열이다.\n",
    "t_bias = tf.constant([10],dtype=tf.float32)\n",
    "\n",
    "X = tf.random.normal(mean=0, stddev=1, shape=(N, n_feature))\n",
    "Y = tf.reduce_sum(t_weights * X, axis = 1) + t_bias #tf.reduce_sum에서 axis =1을 활용해서 가로행을 기준으로 더해나간 값과 t_bias와 더하게 된다.\n",
    "print(Y)\n",
    "Y = Y >5 #이렇게만하면, Y의 결과는 True와 False두개의 bool형 데이터 유형으로 구성된다.\n",
    "print(Y)\n",
    "Y = tf.cast(Y,tf.int32) #우리는 Y값이 0,1로 구성되길 바라므로, tf.cast(data,tf.int32)를 활용하여 바꿨다.\n",
    "print(Y)\n",
    "      \n",
    "\n",
    "print(\"X(shape/dtype/data): {} / {} \\n{}\\n\".format(X.shape,X.dtype,X.numpy()))\n",
    "print(\"Y(shape/dtype/data): {} / {} \\n{}\\n\".format(Y.shape,Y.dtype,Y.numpy()))\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "908d6398-045b-417a-86a8-9ae4e716fe94",
   "metadata": {},
   "source": [
    "## Code.4-1-3: Dataset for Multi-class Classification\n",
    "\n",
    "다양한 class로 분류함으로써, 4사분면에서 데이터를 분류하여 시각화해보자."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "4570dc18",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "X(shape/dtype/data): (150, 2) / <dtype: 'float32'> \n",
      "[[ -2.1791568   11.743214  ]\n",
      " [ -1.1768718   11.322936  ]\n",
      " [ -3.2494752   12.229288  ]\n",
      " [ -1.843529     8.33716   ]\n",
      " [ -1.372575     9.092312  ]\n",
      " [ -1.3203382   10.523492  ]\n",
      " [  0.7013829   11.9042    ]\n",
      " [ -0.96231055  10.81919   ]\n",
      " [ -2.6125207    8.744015  ]\n",
      " [ -3.5714178   10.346063  ]\n",
      " [ -1.6565803    9.787378  ]\n",
      " [ -2.2811222    9.416257  ]\n",
      " [ -1.0894097    9.710781  ]\n",
      " [ -0.99777734  10.321658  ]\n",
      " [ -1.6507599   13.898917  ]\n",
      " [ -2.4062681   10.523418  ]\n",
      " [ -2.085828     9.078911  ]\n",
      " [ -1.428096    10.989392  ]\n",
      " [ -2.3829079   13.187598  ]\n",
      " [ -0.3353722    9.724995  ]\n",
      " [ -2.1782699   11.827735  ]\n",
      " [ -1.1769705   10.167605  ]\n",
      " [ -1.0988215   10.399112  ]\n",
      " [ -2.4105387    9.9230385 ]\n",
      " [ -4.26136      9.019114  ]\n",
      " [ -2.957835    11.523238  ]\n",
      " [ -2.3975534   11.743946  ]\n",
      " [ -2.6559846    9.971324  ]\n",
      " [ -2.7464967   10.019613  ]\n",
      " [ -0.19463038  12.8663435 ]\n",
      " [  6.049658   -11.289033  ]\n",
      " [  8.079532   -11.216526  ]\n",
      " [  7.046034   -10.948851  ]\n",
      " [  6.1084604  -11.77734   ]\n",
      " [  6.2714195  -11.737674  ]\n",
      " [  6.918339   -11.881831  ]\n",
      " [  7.5968175  -10.782512  ]\n",
      " [  6.3438115  -11.720507  ]\n",
      " [  6.4320784  -11.8013115 ]\n",
      " [  5.4002485   -8.827318  ]\n",
      " [  6.773854   -11.434821  ]\n",
      " [  4.5708475  -12.615951  ]\n",
      " [  7.2627525  -11.675693  ]\n",
      " [  5.6053247   -9.039854  ]\n",
      " [  6.4802957  -11.547752  ]\n",
      " [  6.6456223  -13.081285  ]\n",
      " [  5.7147393  -12.3151455 ]\n",
      " [  6.8169703  -11.987863  ]\n",
      " [  7.196249   -11.154864  ]\n",
      " [  5.1650763  -10.883366  ]\n",
      " [  5.4735584  -12.544831  ]\n",
      " [  6.7445793  -13.427383  ]\n",
      " [  6.30368    -10.712086  ]\n",
      " [  5.927764    -9.75011   ]\n",
      " [  6.041825   -12.009548  ]\n",
      " [  6.4750314  -11.288256  ]\n",
      " [  5.712855   -11.613802  ]\n",
      " [  5.798179   -10.835359  ]\n",
      " [  5.988726   -10.568803  ]\n",
      " [  7.1788406  -13.639751  ]\n",
      " [ 13.070771    13.361355  ]\n",
      " [ 13.357488    11.883313  ]\n",
      " [ 14.043748    11.820019  ]\n",
      " [ 15.141864    10.520761  ]\n",
      " [ 15.296416    11.866712  ]\n",
      " [ 14.499203    10.599172  ]\n",
      " [ 15.287035    11.835009  ]\n",
      " [ 12.737348    11.6133    ]\n",
      " [ 16.086075    11.3377285 ]\n",
      " [ 14.192786    12.627187  ]\n",
      " [ 14.579495    12.030084  ]\n",
      " [ 14.024317    11.674636  ]\n",
      " [ 14.469791    10.680583  ]\n",
      " [ 13.691166     9.72559   ]\n",
      " [ 13.456875    10.81184   ]\n",
      " [ 15.813228    11.400434  ]\n",
      " [ 15.306206    10.581607  ]\n",
      " [ 13.609046    10.506288  ]\n",
      " [ 14.250392    11.19238   ]\n",
      " [ 14.885433    10.916672  ]\n",
      " [ 15.064444    10.660807  ]\n",
      " [ 14.303306     9.082177  ]\n",
      " [ 13.211147    11.020943  ]\n",
      " [ 14.778942    10.521986  ]\n",
      " [ 15.71119     10.512127  ]\n",
      " [ 13.445131    11.236243  ]\n",
      " [ 15.928774    10.7457905 ]\n",
      " [ 14.193494    13.943795  ]\n",
      " [ 15.3090515   12.573777  ]\n",
      " [ 15.2338915   11.443506  ]\n",
      " [  9.647282    -5.4919434 ]\n",
      " [ 10.419219    -4.2695684 ]\n",
      " [ 10.289035    -6.6833754 ]\n",
      " [  8.900079    -5.627659  ]\n",
      " [ 10.650987    -6.6043677 ]\n",
      " [  8.35306     -4.5835376 ]\n",
      " [ 10.381484    -6.2389793 ]\n",
      " [ 10.169802    -7.9168453 ]\n",
      " [  9.334589    -6.852154  ]\n",
      " [  9.054532    -4.23575   ]\n",
      " [ 11.341249    -6.483221  ]\n",
      " [  9.502878    -5.1456513 ]\n",
      " [ 11.040692    -5.1854606 ]\n",
      " [  8.781826    -4.889455  ]\n",
      " [  8.485224    -6.111207  ]\n",
      " [  9.73817     -3.9965878 ]\n",
      " [ 10.239103    -6.2600756 ]\n",
      " [  9.719011    -4.040002  ]\n",
      " [ 11.087916    -6.678778  ]\n",
      " [  9.385182    -5.275433  ]\n",
      " [ 10.769119    -6.0182796 ]\n",
      " [  9.150802    -6.636719  ]\n",
      " [ 10.14839     -5.4593067 ]\n",
      " [  9.3442745   -6.417324  ]\n",
      " [ 10.727105    -6.1700726 ]\n",
      " [  9.152971    -4.6826763 ]\n",
      " [  9.949039    -7.1765084 ]\n",
      " [ 11.10257     -5.6003146 ]\n",
      " [ 11.462259    -4.2109804 ]\n",
      " [ 10.448987    -5.7994604 ]\n",
      " [-13.06359    -11.621039  ]\n",
      " [-13.810136   -10.7357435 ]\n",
      " [-13.731049   -12.855165  ]\n",
      " [-12.097379   -11.87853   ]\n",
      " [-11.648323   -10.479592  ]\n",
      " [-11.756209   -11.979172  ]\n",
      " [-10.980416   -11.440313  ]\n",
      " [-12.040407   -12.234511  ]\n",
      " [-12.1733055  -10.813641  ]\n",
      " [-12.43985    -10.002569  ]\n",
      " [-13.459991   -12.321049  ]\n",
      " [-12.686069   -10.791904  ]\n",
      " [-13.87928    -12.542279  ]\n",
      " [-11.386905   -10.512693  ]\n",
      " [-11.3938055  -12.404401  ]\n",
      " [-11.904203   -10.60007   ]\n",
      " [-12.170214   -11.48442   ]\n",
      " [-11.916602   -11.892173  ]\n",
      " [-13.197354   -10.878806  ]\n",
      " [-12.227479   -12.125834  ]\n",
      " [-13.258137   -10.880692  ]\n",
      " [-11.181535   -10.010428  ]\n",
      " [-12.866365   -12.612457  ]\n",
      " [-13.384962   -11.594684  ]\n",
      " [-12.910648   -13.555233  ]\n",
      " [-13.009242    -9.108955  ]\n",
      " [-12.040099   -10.81887   ]\n",
      " [-13.824675   -11.746807  ]\n",
      " [-12.825402   -12.150887  ]\n",
      " [-11.674247   -10.085056  ]]\n",
      "\n",
      "Y(shape/dtype/data): (150, 1) / <dtype: 'int32'> \n",
      "[[1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [1]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [2]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [3]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [4]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]\n",
      " [5]]\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import tensorflow as tf\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "\n",
    "\n",
    "plt.style.use(\"seaborn\")\n",
    "\n",
    "N,n_feature = 30,2\n",
    "n_class = 5\n",
    "\n",
    "X = tf.zeros(shape=(0,n_feature)) #우선 빈껍데기의 X datasets를 만들어준다.\n",
    "Y = tf.zeros(shape = (0,1),dtype=tf.int32) #우선 빈껍데기의 X datasets를 만들어준다.\n",
    "\n",
    "fig, ax = plt.subplots(figsize=(5,5))\n",
    "\n",
    "tf.random.set_seed(2) #아래 for문에서 random을 실행했는데, 동일한 값이 나온다면, random.set_seed()를 실행하면 된다.\n",
    "#컴퓨터는 random의 개념이 없다. 이 seed에서 응용하여 실행하는건데, 만약 random을 통제하고 싶으면 set_seed를 진행해보면 될것이다.\n",
    "\n",
    "for class_idx in range(n_class):\n",
    "    center = tf.random.uniform(minval=-15,maxval=15,shape=(2,)) #군집의 중앙을 임의로 설정한다.\n",
    "    #print(center)\n",
    "    ax.scatter(center[0],center[1]) #설정한 center는 2,1의 형태들로 구성되어있으므로, [0]이 x좌표/[1]가 Y좌표를 뜻한다.그에 맞게 그래프에 묘사해보자.\n",
    "    #군집의 중앙인 center를 중심으로 30개의 점들을 만들어보자.\n",
    "    x1 = center[0] + tf.random.normal(shape=(N,1)) #center를 중심으로 정규화된 값들을 x좌표를 뜻했던 [0]에 더해준다.\n",
    "    x2 = center[1] + tf.random.normal(shape=(N,1)) #center를 중심으로 정규화된 값들을 Y좌표를 뜻했던 [1]에 더해준다.\n",
    "    \n",
    "    #ax.scatter(x1.numpy(),x2.numpy())\n",
    "    \n",
    "    x = tf.concat((x1,x2),axis=1) #concat은 두개의 matrix를 결합할때, 사용한다. axis=1은 나란히 세웠을때 가로로 합하고, axis=0은 밑으로 행을 추가하여 들어간다.\n",
    "    y = (class_idx+1) * tf.ones(shape=(N,1),dtype=tf.int32)\n",
    "    #print(x.shape,y.shape) 결과를 보면, x는 class당 30개의 데이터가 있고 x,y좌표가 있어서 (30,2)이고 Y는 30개 데이터에 각각 class_index값이 들어 있기때문에 (30,1)이다.\n",
    "    \n",
    "    ax.scatter(x[:,0].numpy(),x[:,1].numpy(),alpha=0.5)\n",
    "    \n",
    "    X = tf.concat((X,x),axis=0)\n",
    "    Y = tf.concat((Y,y),axis=0)\n",
    "    \n",
    "    #print(X.shape,Y.shape) #데이터가 class당 30개씩 추가되는것을 볼수있다.\n",
    "    \n",
    "print(\"X(shape/dtype/data): {} / {} \\n{}\\n\".format(X.shape,X.dtype,X.numpy()))\n",
    "print(\"Y(shape/dtype/data): {} / {} \\n{}\\n\".format(Y.shape,Y.dtype,Y.numpy()))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4e5768a2-79f7-486d-bd2a-b775401ac780",
   "metadata": {},
   "source": [
    "## Code.4-1-4: Dataset for Multi-class Classification with One-hot Encoding\n",
    "\n",
    "분석을 위한 dataset을 세팅하는 과정에서 one-hot Encodin이 필요할때가 많으므로, Y값을 one-hot encoding해보자."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "7014b735",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "X(shape/dtype/data): (24, 2) / <dtype: 'float32'> \n",
      "[[-7.7804599e+00 -1.4514036e+00]\n",
      " [-9.2715683e+00 -1.4012587e+00]\n",
      " [-8.2466431e+00 -2.6581371e-01]\n",
      " [-6.8469915e+00 -1.8873692e+00]\n",
      " [-7.4717879e+00 -6.8177998e-01]\n",
      " [-8.6728344e+00 -9.8943710e-05]\n",
      " [-8.9477692e+00 -2.7786539e+00]\n",
      " [-9.2207966e+00 -1.5163965e+00]\n",
      " [-3.7383196e+00  5.7333441e+00]\n",
      " [-3.8581629e+00  6.0072632e+00]\n",
      " [-2.1706059e+00  7.7524834e+00]\n",
      " [-3.4745011e+00  6.8418131e+00]\n",
      " [-4.9940476e+00  5.9489036e+00]\n",
      " [-4.5405226e+00  6.3951921e+00]\n",
      " [-4.4699235e+00  9.3566685e+00]\n",
      " [-5.6820736e+00  8.2153749e+00]\n",
      " [ 1.2090342e+01  9.6027374e+00]\n",
      " [ 1.3964678e+01  9.1864586e+00]\n",
      " [ 1.3449987e+01  8.7953568e+00]\n",
      " [ 1.1617389e+01  9.4548969e+00]\n",
      " [ 1.2556372e+01  9.6204929e+00]\n",
      " [ 1.0825834e+01  8.5516663e+00]\n",
      " [ 1.3982346e+01  8.0003138e+00]\n",
      " [ 1.1819842e+01  8.3680372e+00]]\n",
      "\n",
      "Y(shape/dtype/data): (24, 3) / <dtype: 'int32'> \n",
      "[[1 0 0]\n",
      " [1 0 0]\n",
      " [1 0 0]\n",
      " [1 0 0]\n",
      " [1 0 0]\n",
      " [1 0 0]\n",
      " [1 0 0]\n",
      " [1 0 0]\n",
      " [0 1 0]\n",
      " [0 1 0]\n",
      " [0 1 0]\n",
      " [0 1 0]\n",
      " [0 1 0]\n",
      " [0 1 0]\n",
      " [0 1 0]\n",
      " [0 1 0]\n",
      " [0 0 1]\n",
      " [0 0 1]\n",
      " [0 0 1]\n",
      " [0 0 1]\n",
      " [0 0 1]\n",
      " [0 0 1]\n",
      " [0 0 1]\n",
      " [0 0 1]]\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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XrW2tuqdd97RmjVr9Oyzz1Zs35YuXaqTJ0+mj33fl2VZkgZ+W93d3aVq2oQN79u1116r1tZWXXPNNdqzZ4++/e1va+PGjaO+v2B/0dbWVrW2to75unA4rJ6envRxT0+PJk+eXKhm5V2mfvb19clxBu6VccMNN+j06dND/qerNMP/Rp7nVWwYDDdnzhzNnj1blmVpzpw5amxsVEdHh2bMmFHqpuWFbV+cvFXab2ssS5YsSfdnyZIl2r59+yVfX/LV2HA4rGAwqBMnTsj3fR04cEA33HBDqZs1IY8++mh6tPfmm2/q8ssvr9igkwZOPezfv1/SwGJSS0tLiVuUPz//+c+1a9cuSdLp06cVjUYViURK3Kr8mT9/fnomtX///or/bQ1277336s9//rMk6ZVXXhnzPH9Z/PP8la98RV/84hfluq5uvvlmXXfddaVu0oSsXbtW999/v/bt2yfHcbRz585SN2lClixZopdeeknLly+X7/vasWNHqZuUN3fddZcefPBBrVixQpZlaceOHVUzapWkjRs36stf/rK++c1vau7cuVq6dGmpm5Q327Zt0/bt2xUMBjVt2rQxR3bsegLACCWfxgJAMRB2AIxA2AEwAmEHwAiEHQAjEHYAjEDYATACYQfACP8PnQW8pvzbCYEAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import tensorflow as tf\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "plt.style.use(\"seaborn\")\n",
    "\n",
    "N,n_feature = 8,2\n",
    "n_class = 3\n",
    "\n",
    "X = tf.zeros(shape=(0,n_feature))\n",
    "Y = tf.zeros(shape = (0,),dtype=tf.int32) #one-hot encoding을 위해서는 Y가 matrix형태면 안된다. vector형태여야한다.\n",
    "\n",
    "fig, ax = plt.subplots(figsize=(5,5))\n",
    "\n",
    "tf.random.set_seed(1) \n",
    "\n",
    "for class_idx in range(n_class):\n",
    "    center = tf.random.uniform(minval=-15,maxval=15,shape=(2,))\n",
    "\n",
    "    ax.scatter(center[0],center[1])\n",
    " \n",
    "    x1 = center[0] + tf.random.normal(shape=(N,1))\n",
    "    x2 = center[1] + tf.random.normal(shape=(N,1)) \n",
    "    \n",
    "    x = tf.concat((x1,x2),axis=1)\n",
    "    y = class_idx * tf.ones(shape=(N,),dtype=tf.int32)\n",
    "\n",
    "    ax.scatter(x[:,0].numpy(),x[:,1].numpy(),alpha=0.5)\n",
    "    \n",
    "    X = tf.concat((X,x),axis=0)\n",
    "    Y = tf.concat((Y,y),axis=0)\n",
    "    \n",
    "Y = tf.one_hot(Y,depth=n_class, dtype=tf.int32) #one-hot encoding을 실행한 것.\n",
    "print(\"X(shape/dtype/data): {} / {} \\n{}\\n\".format(X.shape,X.dtype,X.numpy()))\n",
    "print(\"Y(shape/dtype/data): {} / {} \\n{}\\n\".format(Y.shape,Y.dtype,Y.numpy()))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c6f7277b",
   "metadata": {},
   "source": [
    "## Code.4-1-5: Dataset Object"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "359d88a7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(32, 5) (32,)\n",
      "(32, 5) (32,)\n",
      "(32, 5) (32,)\n",
      "(4, 5) (4,)\n"
     ]
    }
   ],
   "source": [
    "import tensorflow as tf\n",
    "\n",
    "N, n_feature = 100,5\n",
    "batch_size=32\n",
    "\n",
    "t_weights = tf.constant([1,2,3,4,5],dtype=tf.float32)\n",
    "t_bias = tf.constant([10],dtype=tf.float32)\n",
    "\n",
    "X = tf.random.normal(mean=0,stddev=1,shape=(N,n_feature))\n",
    "Y = tf.reduce_sum(t_weights*X,axis=1)+t_bias\n",
    "\n",
    "dataset = tf.data.Dataset.from_tensor_slices((X,Y)) #tf.data.Dataset은 dataset을 만들어주는 함수다.(api다,function이다.)/from_tensor_slices은 dataset을 하나의 odject로 만들어준다.\n",
    "#from_tensor_slices는 위와 같은 사이즈의 tensor정도는 구동할 수 있지만, 큰 규모의 tensor를 구동하기에는 힘들다.\n",
    "dataset = dataset.batch(batch_size).shuffle(70)\n",
    "\n",
    "for x,y in dataset:\n",
    "    print(x.shape,y.shape)\n",
    "    \n",
    "#모델에 input을 넣기 전에 input pipeline을 진행하는 것이 모델을 구현하는 것보다 더 중요하다. input이 어떻게 들어가냐에 따라 성과에도 영향을 주기 때문에 그만큼 중요하고, 공드려야 하는 부분이다."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ea65f56e",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3.9 (tensorflow)",
   "language": "python",
   "name": "tensorflow"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
